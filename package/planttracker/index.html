<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='Extracts growth, survival, and local neighborhood density
  information from repeated, fine-scale maps of organism occurrence. Further
  information about this package can be found in our journal article,
  "plantTracker: An R package to translate maps of plant occurrence into
  demographic data" published in 2022 in Methods in Ecology and Evolution
  (Stears, et al., 2022) &lt;doi:10.1111/2041-210X.13950&gt;. '>
<title>Extract Demographic and Competition Data from Fine-Scale Maps • plantTracker</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Extract Demographic and Competition Data from Fine-Scale Maps">
<meta property="og:description" content='Extracts growth, survival, and local neighborhood density
  information from repeated, fine-scale maps of organism occurrence. Further
  information about this package can be found in our journal article,
  "plantTracker: An R package to translate maps of plant occurrence into
  demographic data" published in 2022 in Methods in Ecology and Evolution
  (Stears, et al., 2022) &lt;doi:10.1111/2041-210X.13950&gt;. '>
<meta property="og:image" content="http://www.astearsresearch.com/package/plantTracker/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">

    <a class="navbar-brand me-2" href="index.html">plantTracker</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/Suggested_plantTracker_Workflow.html">Suggested `plantTracker` Workflow</a>
    <a class="dropdown-item" href="articles/Using_the_plantTracker_trackSpp_function.html">Using the `plantTracker` `trackSpp()` function</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aestears/plantTracker/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="planttracker-">
<code>plantTracker</code>
<a class="anchor" aria-label="anchor" href="#planttracker-"></a>
</h1>
</div>
<!-- badges: start -->

<p><a href="https://opensource.org/license/mit/" class="external-link"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a> <a href="https://zenodo.org/badge/latestdoi/353094728" class="external-link"><img src="https://zenodo.org/badge/353094728.svg" alt="DOI"></a> <!-- badges: end --></p>
<p>Welcome to <code>plantTracker</code>! This package was designed to transform <strong>long-term quadrat maps</strong> that show plant occurrence and size into <strong>demographic data</strong> that can be used to answer questions about population and community ecology.</p>
<div class="section level2">
<h2 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ul>
<li>
<a href="#Installation">Installing <code>plantTracker</code></a><br>
</li>
<li><a href="#issues">Contributing</a></li>
<li><a href="#license">License</a></li>
<li><a href="#contact">Contact</a></li>
<li><a href="#ShinyApps">Interactive tools to explore plantTracker functions</a></li>
<li>
<a href="#how_to_use">How to Use <code>plantTracker</code></a>
<ul>
<li><a href="#prep_data">Prepare data for use in <code>plantTracker</code></a></li>
<li><a href="#check_dat">Ensure data is in the correct format with <code>checkDat()</code></a></li>
<li><a href="#trackSpp">Track individuals through time using <code>trackSpp()</code></a></li>
<li><a href="#getNeigh">Calculate local neighborhood density using <code>getNeighbors()</code></a></li>
<li><a href="#next">Further analysis with more <code>plantTracker</code> functions</a></li>
</ul>
</li>
</ul>
<p><a id="Installation"></a></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install <code>plantTracker</code> from <a href="https://CRAN.R-project.org/package=plantTracker" class="external-link">CRAN</a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"plantTracker"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, you can install the current version of <code>plantTracker</code> from <a href="https://github.com/" class="external-link">GitHub</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"aestears/plantTracker"</span><span class="op">)</span></span></code></pre></div>
<p><a id="issues"></a></p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Please report any problems that you encounter while using <code>plantTracker</code> as “issues” on (our GitHub repository)[<a href="https://github.com/aestears/plantTracker/issues/" class="external-link uri">https://github.com/aestears/plantTracker/issues/</a>]. Help us make this package better!</p>
<p><a id="license"></a></p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This package is licensed under MIT License Copyright (c) 2022 Alice Stears</p>
<p><a id="contact"></a></p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>Questions about <code>plantTracker</code> can be forwarded to Alice Stears, the package maintainer, at <a href="mailto:alice.e.stears@gmail.com" class="email">alice.e.stears@gmail.com</a>.</p>
<p><a id="ShinyApps"></a></p>
</div>
<div class="section level2">
<h2 id="interactive-tools-to-explore-planttracker-functions">Interactive tools to explore plantTracker functions<a class="anchor" aria-label="anchor" href="#interactive-tools-to-explore-planttracker-functions"></a>
</h2>
<p>This Shiny app that lets you change arguments in the trackSpp() function, and see how that impacts individual ID assignment in an example dataset. You can open it in it's own browser window <a href="https://astears.shinyapps.io/shinyapp/">here</a> <iframe height="400" width="100%" frameborder="no" src="https://astears.shinyapps.io/shinyapp/"> </iframe>
<p><a id="how_to_use"></a></p>
</div>
<div class="section level2">
<h2 id="how-to-use-the-planttracker-r-package">How to use the <code>plantTracker</code> R package<a class="anchor" aria-label="anchor" href="#how-to-use-the-planttracker-r-package"></a>
</h2>
<p>The material below explains how to use <code>plantTracker</code>, starting with formatting your data correctly. This information is also available in the ‘Suggested <code>plantTracker</code> Workflow’ vignette, which is included in the package.</p>
<p><a id="prep_data"></a></p>
<div class="section level3">
<h3 id="id_1-prepare-data">
<em>1.</em> Prepare data<a class="anchor" aria-label="anchor" href="#id_1-prepare-data"></a>
</h3>
<p>The functions in <code>plantTracker</code> require data in a specific format. <code>plantTracker</code> includes an example dataset that consists of two pieces: <code>grasslandData</code> and <code>grasslandInventory</code>. You can load these example datasets into your global environment by calling <code>data(grasslandData)</code> and <code>data(grasslandInventory)</code>. You can view the documentation for these datasets by calling<code><a href="reference/grasslandData.html">?grasslandData</a></code> and <code><a href="reference/grasslandInventory.html">?grasslandInventory</a></code>.</p>
<p>Most <code>plantTracker</code> functions require two data objects. The first is a data frame that contains the location and metadata for each mapped individual, which we from now on will call <code>dat</code>. The second is a list that contains a vector of years in which each quadrat was sampled, which we from now on will cal <code>inv</code>.</p>
<p>Below are the basic requirements for these data objects.</p>
<p><a id="dat_data"></a></p>
<div class="section level4">
<h4 id="id_11-the-dat-data-frame-must---">
<em>1.1</em> The <code>dat</code> data frame must . . .<a class="anchor" aria-label="anchor" href="#id_11-the-dat-data-frame-must---"></a>
</h4>
<ul>
<li>… be an <code>sf</code> data.frame. More on this below in section <a href="#dat_to_sf"><em>1.1.1</em></a>…</li>
<li>… contain a row for each individual observation in each year.</li>
<li>… have a column that contains character strings indicating the specific epithet for each observation. This column must be a character data type. The function expects this column to be called “Species”, but a different name can be specified in function calls.</li>
<li>… have a column that contains character strings indicating the site at which each observation was collected. This is a level of classification “above” the quadrat (i.e. all quadrats measured at the Central Plains Experimental Range in Nunn, CO might have the value “CO” in this column). This column must be a character data type. The function expects this column to be called “Site”, but a different name can be specified in function calls.</li>
<li>… have a column that contains character strings indicating the quadrat at which each observation was collected. This column must be a character data type. The function expects this column to be called “Quad”, but a different name can be specified in function calls.</li>
<li>… have a column that contains a value indicating the year when this individual observation was collected. This must be a numeric data type, and must be either a four or two digit year number. The function expects this column to be called “Year”, but a different name can be specified in function calls.</li>
<li>… have a column (almost always called “geometry” in the <code>sf</code> package data format) that contains a polygon representing the location of each observation. Each observation must be a <code>POLYGON</code> or <code>MULTIPOLYGON</code>. Data cannot be stored as <code>POINTS</code>.</li>
<li>If the data was collected such that forbs or small grasses were mapped as points and digitized as such, then these observations must be converted to polygons. We recommend that you convert them to small circular polygons with an identical radius. If you do this transformation, we also recommend that you include a column that indicates whether each row was originally mapped as a polygon or a point, since the demographic data that deals with size will be relatively meaningless for observations originally mapped as points.</li>
<li>
<code>dat</code> does not need to have a coordinate reference system (i.e. CRS can be “NA”), but it can have one if you’d like.</li>
<li>… <em>not</em> have columns called “neighbors”, “nearEdge”, “trackID”, “age”, “size_tplus1”, “recruit”, “survives_tplus1”, “basalArea_ramet”, or “basalArea_genet”, since these columns are added by <code>plantTracker</code> functions.</li>
<li>Note: Additional columns can be included in the input data.frame, although they might not be included in the output of <code>plantTracker</code> functions.</li>
</ul>
<p>Here are the first few rows of a possible <code>dat</code> input data.frame:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 6 features and 6 fields</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -0.000160084 ymin: 0.4334812 xmax: 0.286985 ymax: 0.9419673</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; CRS:           NA</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;                 Species Type Site Quad Year sp_code_6</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 1 Heteropogon contortus poly   AZ  SG2 1922    HETCON</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 2 Heteropogon contortus poly   AZ  SG2 1922    HETCON</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 3 Heteropogon contortus poly   AZ  SG2 1922    HETCON</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 4 Heteropogon contortus poly   AZ  SG2 1922    HETCON</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; 5 Heteropogon contortus poly   AZ  SG2 1922    HETCON</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; 6 Heteropogon contortus poly   AZ  SG2 1922    HETCON</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;                         geometry</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; 1 POLYGON ((0.237747 0.908835...</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; 2 POLYGON ((0.2833037 0.85959...</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; 3 POLYGON ((0.008583123 0.449...</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; 4 POLYGON ((0.1480142 0.46983...</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt; 5 POLYGON ((0.03573306 0.5259...</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt; 6 POLYGON ((0.2441894 0.52689...</span></span></code></pre></div>
<ul>
<li>Note: that the required columns are “Species”, “Site”, “Quad”, “Year”, and “geometry”. The additional columns “Type” and “sp_code_6” are just “along for the ride” in any analysis using <code>plantTracker</code> functions.</li>
</ul>
<p>Here’s what some of the example <code>dat</code> data (from the “SG2” quadrat at the “AZ” site in 1922) look like when plotted spatially:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; ℹ Please use `linewidth` instead.</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; generated.</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="reference/figures/README-unnamed-chunk-3-1.png" alt="Figure 1.1 : Spatial map of a subset of example 'dat' dataset" width="100%"><p class="caption">
Figure 1.1 : Spatial map of a subset of example ‘dat’ dataset
</p>
</div>
<p>It’s important to note that, while <code>plantTracker</code> was designed to be used with small-scale maps of plant occurrence in quadrats, it is conceivably possible to use other styles of map data in <code>plantTracker</code> functions. All that is required is a single mapped basal area (or point location converted to a small polygon) at each time point for each organism (or ramet), and is accompanied by the required metadata detailed above. For example, <code>plantTracker</code> functions could be used to estimate tree demographic rates at the scale of 100 m x 50 m plots.</p>
<p><a id="dat_to_sf"></a></p>
<div class="section level5">
<h5 id="id_111-get-your-data-into-the-sf-data-format">
<em>1.1.1</em> Get your data into the <code>sf</code> data format<a class="anchor" aria-label="anchor" href="#id_111-get-your-data-into-the-sf-data-format"></a>
</h5>
<p>As mentioned above, <code>plantTracker</code> uses the <code>sf</code> R package to deal with spatial data. The map data that <code>plantTracker</code> was built to analyze is inherently spatial, so you need to know how to the basics of dealing with spatial data in R if you want to use <code>plantTracker</code>! There are many good resources to help you orient yourself to working with spatial data in R generally:</p>
<ul>
<li>
<a href="https://cengel.github.io/R-spatial/intro.html" class="external-link uri">https://cengel.github.io/R-spatial/intro.html</a><br>
</li>
<li><a href="https://www.r-bloggers.com/2021/06/using-geospatial-data-in-r/" class="external-link uri">https://www.r-bloggers.com/2021/06/using-geospatial-data-in-r/</a></li>
</ul>
<p>And the <code>sf</code> package more specifically:</p>
<ul>
<li>
<a href="https://CRAN.R-project.org/package=sf" class="external-link uri">https://CRAN.R-project.org/package=sf</a><br>
</li>
<li><a href="https://r-spatial.github.io/sf/" class="external-link uri">https://r-spatial.github.io/sf/</a></li>
</ul>
<p>These resources provide a great orientation, and while I recommend looking over them if you’re new to working with spatial data in R, I’ve included a brief tutorial for uploading shapefiles into R as <code>sf</code> data frames.</p>
<p>Most of the published chart-quadrat datasets have the map data stored as shapefiles in complex file structures, which can be a bit confusing to navigate. <code>plantTracker</code> requires all of your data (for all species, plots and years) to be in one single data frame. <em>This example shows how you might navigate through a complex file structure to to pull out shapefiles and put them into one single <code>sf</code> data frame. for further analysis with <code>plantTracker</code>.</em> For this example, I’ll use a subset of the data from the Santa Rita Experimental Range in Arizona, which has been published in <a href="https://figshare.com/articles/dataset/Data_Paper_Data_Paper/3553581?file=5622201" class="external-link">this data paper</a>. In this dataset, shapefiles for each quadrat are stored in their own folder. Within that folder there are two shapefiles for each year: one that contains map data for polygons, and one that contains data for points. The following code reads in those shapefiles, transforms the points to polygons of a fixed radius, and puts all the data into one <code>sf</code> data frame. If you want to follow along, download the “shapefiles.zip” file from the data paper, un-zip it, and name it “AZ_shapefiles”. The dataset that is the result of this example is the same as part of the “grasslandData” dataset included in <code>plantTracker</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#  save a character vector of the file names in the file that contains the </span></span>
<span><span class="co"># shapefiles (in this case, called "CO_shapefiles"), each of which is a quadrat</span></span>
<span><span class="co"># note: 'wdName' is a character string indicating the path of the directory </span></span>
<span><span class="co"># containing the 'AZ_shapefiles' folder</span></span>
<span><span class="va">quadNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdName</span>,<span class="st">"AZ_shapefiles/"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># trim the quadrats down to 2, for the sake of runtime in this example </span></span>
<span><span class="va">quadNames</span> <span class="op">&lt;-</span> <span class="va">quadNames</span><span class="op">[</span><span class="va">quadNames</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SG2"</span>, <span class="st">"SG4"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># now we'll loop through the quadrat folders to download the data</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span><span class="co">#length(quadNames)) {</span></span>
<span>  <span class="co"># get the names of the quadrat for this iteration of the loop</span></span>
<span>  <span class="va">quadNow</span> <span class="op">&lt;-</span> <span class="va">quadNames</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="co">#  get a character vector of the unique quad/Year combinations of data in </span></span>
<span>  <span class="co"># this folder that contain polygon data</span></span>
<span>  <span class="va">quadYears</span> <span class="op">&lt;-</span> <span class="va">quadYears</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdName</span>, <span class="st">"AZ_shapefiles/"</span>,<span class="va">quadNow</span>,<span class="st">"/"</span><span class="op">)</span>,</span>
<span>    pattern <span class="op">=</span> <span class="st">".shp$"</span><span class="op">)</span>, split <span class="op">=</span> <span class="st">".shp"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># loop through each of the years in this quadrat</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quadYears</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># save the name of this quadYear combo</span></span>
<span>    <span class="va">quadYearNow</span> <span class="op">&lt;-</span> <span class="va">quadYears</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>    <span class="co"># read in the shapefile for this quad/year combo as an sf data frame </span></span>
<span>    <span class="co"># using the 'st_read()' function from the sf package </span></span>
<span>    <span class="va">shapeNow</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">wdName</span>,<span class="st">"AZ_shapefiles/"</span>,<span class="va">quadNow</span><span class="op">)</span>, </span>
<span>                            <span class="co">#  the 'dsn' argument is the folder that </span></span>
<span>                            <span class="co"># contains the shapefile files--in this case, </span></span>
<span>                            <span class="co"># the folder for this quadrat</span></span>
<span>                            layer <span class="op">=</span> <span class="va">quadYearNow</span><span class="op">)</span> <span class="co"># the 'layer' argument has the </span></span>
<span>    <span class="co"># name of the shapefile, without the filetype extension! This is because each </span></span>
<span>    <span class="co"># shapefile consists of at least three separate files, each of which has a </span></span>
<span>    <span class="co"># unique filetype extension. </span></span>
<span>    <span class="co"># the shapefiles in this dataset do not have all of the metadata we </span></span>
<span>    <span class="co"># need, and have some we don't need, so we'll remove what we don't need and </span></span>
<span>    <span class="co"># add columns for 'site', 'quad', and 'year'</span></span>
<span>    <span class="va">shapeNow</span><span class="op">$</span><span class="va">Site</span> <span class="op">&lt;-</span> <span class="st">"AZs"</span></span>
<span>    <span class="va">shapeNow</span><span class="op">$</span><span class="va">Quad</span> <span class="op">&lt;-</span> <span class="va">quadNow</span></span>
<span>    <span class="co"># get the Year for the shapefile name--in this case it is the last for </span></span>
<span>    <span class="co"># numbers of the name</span></span>
<span>    <span class="va">shapeNow</span><span class="op">$</span><span class="va">Year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">quadYearNow</span>, split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1900</span></span>
<span>    <span class="co"># determine if the 'current' quad/year contains point data or polygon data</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">quadYearNow</span>, pattern <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># if quadYearNow has point data</span></span>
<span>      <span class="co"># remove the columns we don't need</span></span>
<span>      <span class="va">shapeNow</span> <span class="op">&lt;-</span> <span class="va">shapeNow</span><span class="op">[</span>,<span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">shapeNow</span><span class="op">)</span></span>
<span>                              <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Clone"</span>, <span class="st">"Seedling"</span>, <span class="st">"Area"</span>, <span class="st">"Length"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>      <span class="co"># reformat the point into a a very small polygon </span></span>
<span>      <span class="co"># (a circle w/ a radius of .003 m)</span></span>
<span>      <span class="va">shapeNow</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_buffer</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">shapeNow</span>, dist <span class="op">=</span> <span class="fl">.003</span><span class="op">)</span></span>
<span>      <span class="co"># add a column indicating that this observation was originally </span></span>
<span>      <span class="co"># mapped as a point</span></span>
<span>      <span class="va">shapeNow</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"point"</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="co"># if quadYearNow has polygon data</span></span>
<span>      <span class="co"># remove the columns we don't need</span></span>
<span>      <span class="va">shapeNow</span> <span class="op">&lt;-</span> <span class="va">shapeNow</span><span class="op">[</span>,<span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">shapeNow</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Seedling"</span>, <span class="st">"Canopy_cov"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"area"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>      <span class="co"># add a column indicating that this observation was originally </span></span>
<span>      <span class="co"># mapped as a polygon</span></span>
<span>      <span class="va">shapeNow</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"polygon"</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># now we'll save this sf data frame </span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">j</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span> <span class="co"># if this is the first year in the first quadrat</span></span>
<span>      <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">shapeNow</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="co"># if this isn't the first year in the first quadrat, simply rbind </span></span>
<span>      <span class="co"># the shapeNow sf data frame onto the previous data </span></span>
<span>      <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">shapeNow</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Now, all of the spatial data are in one sf data frame!</span></span>
<span><span class="co"># for the sake of this example, we'll remove data for some species and years in order to make the example run faster (and to make this 'dat' data.frame identical to the "grasslandData" dataset included in this R pakcage).</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Heteropogon contortus"</span>, <span class="st">"Bouteloua rothrockii"</span>, <span class="st">"Ambrosia artemisiifolia"</span>, <span class="st">"Calliandra eriophylla"</span>, <span class="st">"Bouteloua gracilis"</span>, <span class="st">"Hesperostipa comata"</span>, <span class="st">"Sphaeralcea coccinea"</span>, <span class="st">"Allium textile"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span>  <span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Quad</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SG2"</span>, <span class="st">"SG4"</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>             <span class="va">dat</span><span class="op">$</span><span class="va">Year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1922</span><span class="op">:</span><span class="fl">1927</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>In some spatial datasets, observations that were measured as “points” in the field are still stored as “points” in the shapefiles. <code>plantTracker</code> requires all observations to be stored as “polygon” geometry in order to streamline functions, so we need to translate “points” into small polygons of a fixed area. In this case, we’ll transform them into circles with a radius of 1 cm (.01, since this dataset measures area in meters). ‘dat’ has a column called “type.” A value of “point” in this column will tell us that, even though the geometry of the “point” data is now in “polygon” format, the values for basal area and growth are not indicative of the true size of the plant.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We use the function "st_buffer()" to add a buffer of our chosen radius (.01) around each point observation, which will transform each observation into a circle of the "polygon" format with a radius of .01. </span></span>
<span><span class="va">dat_1</span> <span class="op">&lt;-</span> <span class="fu">st_buffer</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span><span class="op">[</span><span class="fu">st_is</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, type <span class="op">=</span> <span class="st">"POINT"</span><span class="op">)</span>,<span class="op">]</span>, dist <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></span>
<span><span class="va">dat_2</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">!</span><span class="fu">st_is</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span>, type <span class="op">=</span> <span class="st">"POINT"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dat_1</span>, <span class="va">dat_2</span><span class="op">)</span></span></code></pre></div>
<p>If you don’t want to download the data and format it into an sf data.frame, you can also use a subset of the “grasslandData” data object stored in this R package. You will just need to subset it to include only the data from the “AZ” site. Code to do this is below:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">grasslandData</span><span class="op">[</span><span class="va">grasslandData</span><span class="op">$</span><span class="va">Site</span> <span class="op">==</span> <span class="st">"AZ"</span>,<span class="op">]</span></span></code></pre></div>
<p><a id="dat_inv"></a></p>
</div>
</div>
<div class="section level4">
<h4 id="id_12-the-inv-list-must---">
<em>1.2</em> The <code>inv</code> list must . . .<a class="anchor" aria-label="anchor" href="#id_12-the-inv-list-must---"></a>
</h4>
<ul>
<li>… be a named list</li>
<li>… have element names that are each a character string identical to the name of a quadrat in <code>dat</code>. There cannot be two elements with the same name, and there cannot be an element with more than one quadrat in its name. There must be an element for each quadrat with data in <code>dat</code>.</li>
<li>… have list elements that are each a numeric vector of years in which each quadrat was sampled. If a quadrat was “skipped” in a year, then that year must be excluded from this vector. The format of the years must be the same as the format of years in <code>dat</code> (i.e. if year is a four-digit number in <code>dat</code>, then it must be a four-digit number in <code>inv</code>). Make sure this is the years the quadrat was actually sampled, not just the years that have data in the <code>dat</code> data frame! This argument allows the function to differentiate between years when the quadrat wasn’t sampled and years when there just weren’t any individuals of a species present in that quadrat. If a quadrat wasn’t sampled in a given year, don’t put an ‘NA’ in <code>inv</code> for that year! Instead, just skip that year.</li>
</ul>
<p>Here is an example of an <code>inv</code> argument that corresponds to the example <code>dat</code> argument above. The quadrats that have data in <code>dat</code> are “SG2” and “SG4”, so there are elements in <code>inv</code> that correspond to each of these quadrats.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">#&gt; $SG2</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; [1] 1922 1923 1924 1925 1926 1927</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; $SG4</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; [1] 1922 1923 1924 1925 1926 1927</span></span></code></pre></div>
<p>If you already have a quadrat inventory as a data frame, it isn’t complicated to reformat it to work with <code>plantTracker</code> functions. For example, if your quadrat inventory data frame looks like this… :</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">#&gt;   quad1 quad2 quad3</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; 1  2000  2000  2000</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; 2  2001  2001    NA</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; 3    NA  2002  2002</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; 4  2003  2003  2003</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; 5  2004  2004  2004</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; 6  2005  2005  2005</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; 7  2006  2006  2006</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; 8  2007  2007  2007</span></span></code></pre></div>
<p>… then do the following to get it into a format ready for <code>plantTracker</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quadInv_DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"quad1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2001</span>, <span class="cn">NA</span>, <span class="fl">2003</span>, <span class="fl">2004</span>, <span class="fl">2005</span>, <span class="fl">2006</span>, <span class="fl">2007</span><span class="op">)</span>,</span>
<span>           <span class="st">"quad2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">:</span><span class="fl">2007</span><span class="op">)</span>, </span>
<span>           <span class="st">"quad3"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="cn">NA</span>, <span class="fl">2002</span>, <span class="fl">2003</span>, <span class="fl">2004</span>, <span class="fl">2005</span>, <span class="fl">2006</span>, <span class="fl">2007</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the 'as.list()' function to transform your data frame into a named list</span></span>
<span><span class="va">quadInv_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">quadInv_DF</span><span class="op">)</span></span>
<span><span class="co"># we still need to remove the 'NA' values, which we can do using the </span></span>
<span><span class="co"># 'lapply()' function</span></span>
<span><span class="op">(</span><span class="va">quadInv_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">quadInv_list</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $quad1</span></span>
<span><span class="co">#&gt; [1] 2000 2001 2003 2004 2005 2006 2007</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $quad2</span></span>
<span><span class="co">#&gt; [1] 2000 2001 2002 2003 2004 2005 2006 2007</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $quad3</span></span>
<span><span class="co">#&gt; [1] 2000 2002 2003 2004 2005 2006 2007</span></span></code></pre></div>
<p><a id="check_dat"></a></p>
</div>
<div class="section level4">
<h4 id="id_13-check-the-inv-and-dat-arguments-using-checkdat">
<em>1.3</em> Check the <code>inv</code> and <code>dat</code> arguments using <code>checkDat()</code>
<a class="anchor" aria-label="anchor" href="#id_13-check-the-inv-and-dat-arguments-using-checkdat"></a>
</h4>
<p>The generic <code><a href="reference/checkDat.html">checkDat()</a></code> function:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/checkDat.html">checkDat</a></span><span class="op">(</span><span class="va">dat</span>, inv <span class="op">=</span> <span class="cn">NULL</span>, species <span class="op">=</span> <span class="st">"Species"</span>, site <span class="op">=</span> <span class="st">"Site"</span>, quad <span class="op">=</span> <span class="st">"Quad"</span>,</span>
<span>  year <span class="op">=</span> <span class="st">"Year"</span>, geometry <span class="op">=</span> <span class="st">"geometry"</span>, reformatDat <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p>This step is optional, but can be useful if you’re unsure whether your <code>dat</code> and <code>inv</code> arguments are in the correct format. The <code>plantTracker</code> function <code><a href="reference/checkDat.html">checkDat()</a></code> takes <code>dat</code> and <code>inv</code> as arguments for the arguments <code>dat</code> and<code>inv</code>, and will return informative error messages if either argument is not in the correct format.</p>
<p>Additional optional arguments to <code><a href="reference/checkDat.html">checkDat()</a></code> are <code>species</code>, <code>site</code>, <code>quad</code>, <code>year</code>, <code>geometry</code>, and <code>reformatDat</code>.</p>
<ul>
<li><p><strong><code>species/site/quad/year/geometry</code></strong> These arguments only need to be included if the columns in <code>dat</code> that contain the data for species, site, quadrat, year and geometry of each observation are <em>different</em> from the names “Species”, “Site”, “Quad”, “Year, and”geometry”. For example, if the column in your version of <code>dat</code> that contains the species identity of each observation is called “species_names”, then the argument <code>species = "species_names"</code> must be included in your call to <code><a href="reference/checkDat.html">checkDat()</a></code>.</p></li>
<li><p><strong><code>reformatDat</code></strong> is a TRUE/FALSE argument that determines whether you want the <code><a href="reference/checkDat.html">checkDat()</a></code> function to return a version of <code>dat</code> that is ready to go into the steps of this workflow. If <code>reformatDat</code> = TRUE then <code><a href="reference/checkDat.html">checkDat()</a></code> will return a list that contains the reformatted version of <code>dat</code>, the reformatted version of <code>inv</code> and an additional element called “userColNames”, which contains the column names in the input version of <code>dat</code> that are different from the expected column names of “Species”, “Site”, “Quad”, “Year, and”geometry” (if there are any). If <code>reformatDat</code> = TRUE, then <code><a href="reference/checkDat.html">checkDat()</a></code> will return a message indicating that your data is ready for the next step. The default value is FALSE.</p></li>
</ul>
<hr>
<p><a id="trackSpp"></a></p>
</div>
</div>
<div class="section level3">
<h3 id="id_2-track-individuals-through-time-using-trackspp">
<em>2</em> Track individuals through time using <code>trackSpp()</code>
<a class="anchor" aria-label="anchor" href="#id_2-track-individuals-through-time-using-trackspp"></a>
</h3>
<p>Now it’s time to transform your raw dataset into demographic data! This is accomplished using the <code><a href="reference/trackSpp.html">trackSpp()</a></code> function. This function follows individual plants from year to year in the same quadrat to determine survival, size in the next year, age, and some additional potentially-useful demographic data. It does this by comparing quadrat maps from sequential years. If there is overlap of individuals of the same species in consecutive years, then the rows in <code>dat</code> that contain data for those overlapping individuals are given the same “trackID”, or unique identifier.</p>
<p>Here is the generic <code><a href="reference/trackSpp.html">trackSpp()</a></code> function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/trackSpp.html">trackSpp</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">inv</span>, <span class="va">dorm</span>, <span class="va">buff</span>, <span class="va">buffGenet</span>, <span class="va">clonal</span>, species <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>  site <span class="op">=</span> <span class="st">"Site"</span>, quad <span class="op">=</span> <span class="st">"Quad"</span>, year <span class="op">=</span> <span class="st">"Year"</span>, geometry <span class="op">=</span> <span class="st">"geometry"</span>,</span>
<span>  aggByGenet <span class="op">=</span> <span class="cn">TRUE</span>, printMessages <span class="op">=</span> <span class="cn">TRUE</span>, flagSuspects <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shrink <span class="op">=</span> <span class="fl">0.1</span>, dormSize <span class="op">=</span> <span class="fl">0.05</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p><a id="trackSpp_args"></a></p>
<div class="section level4">
<h4 id="id_21-function-arguments">
<em>2.1</em> Function arguments<a class="anchor" aria-label="anchor" href="#id_21-function-arguments"></a>
</h4>
<p><code><a href="reference/trackSpp.html">trackSpp()</a></code> takes the following arguments:</p>
<ul>
<li>
<strong><code>dat</code></strong> This is the <code>sf</code> data frame that we’ve been calling <code>dat</code> so far. This must be in the correct format (which you can check before-hand using <code><a href="reference/checkDat.html">checkDat()</a></code>), but informative error messages will be returned if it is incorrect. It <em>must</em> have the columns outlined in Section <a href="#dat_to_sf">1.1</a>, but they can have different names as long as those names are included in this function call (more on that later…).</li>
<li>
<strong><code>inv</code></strong> This is the list of quadrat sampling years we’ve been calling <code>inv</code>. If it is not in the correct format or does not contain data for the correct quadrats, then an informative error message will be returned.</li>
<li>
<strong><code>dorm</code></strong> This is a positive integer value that indicates how long you want the function to allow an individual to be “dormant”. In this case, dormancy can be interpreted as the biological phenomenon where a plant has above-ground tissue present in year 1, is alive underground but with no above-ground tissue in year 2, and then has above-ground tissue in a subsequent year. Dormancy can also be interpreted here as data-collection error, whereby an individual is accidentally not mapped in between years where it was recorded.</li>
</ul>
<p><em>Consider the following example</em>: There is a polygon of species “A” in year 1, which is our “focal individual”. In year 2, there is not a polygon of species “A” that overlaps with our focal individual. In year 3, there is a polygon of species “A” that is in the same location as our focal individual. If <code>dorm = 0</code>, then our focal individual would get a 0 in the survival column, and the polygon of species “A” in year 3 would be considered a new recruit and get a new trackID. If <code>dorm = 1</code>, because there is overlap between two polygons of the same species with only a 1-year gap between when they occur, these two polygons will be considered the same genetic individual, will have the same trackID, and our focal individual will have a “1” in the survival column. In an alternative scenario, in years 3 and 4 there are not polygons of species “A” that are in the same location as our focal individual, but there is a polygon in year 4 that overlaps our focal individual. If <code>dorm = 1</code>, then our focal individual would get a “0” for survival, but if <code>dorm = 2</code>, then it would get a 1 for survival.</p>
<div class="figure" style="text-align: center">
<img src="reference/figures/README-unnamed-chunk-11-1.png" alt="Figure 2.1: A visualization of the 'dormancy' scenario described above." width="100%"><p class="caption">
Figure 2.1: A visualization of the ‘dormancy’ scenario described above.
</p>
</div>
<p>If you’d like to be more specific and perhaps biologically accurate, you can also specify the <code>dorm</code> argument uniquely for each species. For example, it might be that you are confident that your data collectors did not accidentally “miss” any individuals, and your <code>dat</code> data frame contains observations for shrubs or trees, which are very unlikely to go dormant, and small forbs, which are much more likely to go dormant for one or two years. In order to disallow dormancy for trees and shrubs, but to allow dormancy for forbs, you will provide a data frame to the <code>dorm</code> argument instead of a single positive integer value. There will be two columns: 1) a “Species” column that has the species name for each species present in <code>dat</code>, and 2) a column called “dorm” that has positive integer values indicating the dormancy you’d like to allow for each species. Make sure that if you are following the data frame approach, you must provide a dormancy argument for <em>every</em> species that has data in <code>dat</code>. Make sure that the species names in the <code>dorm</code> data frame are spelled exactly the same as they are in <code>dat</code>. The data frame should look something like this:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">#&gt;   Species dorm</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#&gt; 1  tree A    0</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; 2 shrub B    0</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; 3  tree C    0</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; 4  forb D    1</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; 5  forb E    2</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; 6  forb F    1</span></span></code></pre></div>
<ul>
<li><p><em>Important Note:</em> Be very careful about how you define the <code>dorm</code> argument. The bigger the <code>dorm</code> argument, the more likely you are to overestimate survival. For annually-sampled data, I would need a very biologically-compelling reason to to specify a <code>dorm</code> argument greater than 1 year.</p></li>
<li><p><strong><code>buff</code></strong> This is a positive numeric value that indicates how much an individual can move from year 1 to year 2 and still be considered the same individual (receive the same trackID). In addition to accounting for true variation in location of a plant’s stem from year to year, this argument also accounts for small inconsistencies in mapping from year to year. The <code>buff</code> argument must be in the same units as the spatial values in <code>dat</code>. For example, if the spatial data in <code>dat</code> is measured in meters, and you want to allow a plant to “move” 15 cm between year 1 and year 2, then you would include the argument <code>buff = .15</code> in your call to <code><a href="reference/trackSpp.html">trackSpp()</a></code>. If you want to allow no movement, use <code>buff = 0</code>. Below is a visualization of two different <code>buff</code> scenarios.</p></li>
</ul>
<div class="figure" style="text-align: center">
<img src="reference/figures/README-unnamed-chunk-13-1.png" alt="Figure 2.2: With a 10 cm buffer, these polygons in 1922 and 1923 overlap and will be identified by trackSpp() as the **same** individual and receive the same trackID." width="100%"><p class="caption">
Figure 2.2: With a 10 cm buffer, these polygons in 1922 and 1923 overlap and will be identified by trackSpp() as the <strong>same</strong> individual and receive the same trackID.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="reference/figures/README-unnamed-chunk-14-1.png" alt="Figure 2.3: With a 3 cm buffer, these polygons in 1922 and 1923 don't quite overlap, so will be identified by trackSpp() as **different** individuals and receive different trackIDs." width="100%"><p class="caption">
Figure 2.3: With a 3 cm buffer, these polygons in 1922 and 1923 don’t quite overlap, so will be identified by trackSpp() as <strong>different</strong> individuals and receive different trackIDs.
</p>
</div>
<ul>
<li>
<strong><code>clonal</code></strong> This is a logical argument (TRUE or FALSE) that indicates whether you want to allow plants to be clonal or not. In the context of this type of data, “clonal” means that one genetic individual (or “genet”) can be recorded as multiple polygons (or “ramets”). If <code>clonal = TRUE</code>, then multiple polygons in the same year can be part of the same individual and have the same trackID. If <code>clonal = FALSE</code>, then every polygon in a given year is a unique individual and has a unique trackID. This option can be defined globally for all species present in <code>dat</code> by setting <code>clonal</code> equal to FALSE or TRUE in the <code><a href="reference/trackSpp.html">trackSpp()</a></code> function call. Alternatively, <code>clonal</code> can be specified uniquely for each species by creating a data frame that contains a <code>clonal</code> argument for each species (analogous to the data frame for the <code>dorm</code> argument shown in Table 2.1, but with a column called “clonal”).</li>
</ul>
<p>The following arguments to <code><a href="reference/trackSpp.html">trackSpp()</a></code> are only required in certain contexts.</p>
<ul>
<li>
<strong><code>buffGenet</code></strong> is an argument that is only required if <code>clonal = TRUE</code> or if <code>clonal</code> is a data frame that contains at least a single <code>TRUE</code> in the “clonal” column. <code>buffGenet</code> is a numeric value that indicates how close polygons of the same species must be to one another in the first year in order to be considered parts of the same genetic individual (ramets of the same genet). Similar to <code>buff</code>, be very careful and conservative when defining this argument. A large value for <code>buffGenet</code> can quickly lead to the entire quadrat being treated as the same genetic individual! I suggest experimenting with multiple values of <code>buffGenet</code>, looking at maps that show the trackID assignment, and deciding on a value that leads to trackID assignments that make the most biological sense to you. This argument is passed to the <code><a href="reference/groupByGenet.html">groupByGenet()</a></code> function, which assigns the same trackID to individuals that are within the <code>buffGenet</code> buffer of each other. Polygons are only grouped by genet in the first year of data. After that point, grouping by genet happens based on data in previous years. If there are multiple polygons that overlap with a genet in the previous year, they are given the same trackID and are considered ramets belonging to the same genet. The value of <code>buffGenet</code> must be greater than or equal to zero, and must be in the same units as the spatial data in <code>dat</code>. <code>buffGenet</code> can be a single numeric value which will be applied to all species present in <code>dat</code>, or can be specified uniquely for each species by creating a data frame that contains a <code>buffGenet</code> argument for each species (analogous to the data frame for the <code>dorm</code> argument shown in Table 2.1, but with a column called “buffGenet”).</li>
<li>
<strong><code>aggByGenet</code></strong> is a logical argument that is only required if <code>clonal = TRUE</code> or if <code>clonal</code> is a data frame that contains at least a single <code>TRUE</code> in the “clonal” column. This argument determines whether the output data frame from <code><a href="reference/trackSpp.html">trackSpp()</a></code> will have a row for every single ramet, or will be aggregated so that each genet is represented by a single row. If <code>aggByGenet = FALSE</code>, then the output is not aggregated. If <code>aggByGenet = TRUE</code> (the default setting), then the results are aggregated using the <code>plantTracker</code> function <code><a href="reference/aggregateByGenet.html">aggregateByGenet()</a></code>. This function combines the <code>sf</code> “POLYGONS” for each ramet into one <code>sf</code> <code>MULTIPOLYGON</code> for the entire genet, and combines the associated metadata (“Species”, “Site”, “Quad”, “Year”, “trackID”, “basalArea_genet”, “age”, “recruit”, “survives_tplus1”, “size_tplus1”, “nearEdge”) into one row for this genet. Even if the input <code>dat</code> had additional columns, they will not be included in the output of <code>trackSpp</code> if <code>aggByGenet = TRUE</code>, since it is uncertain if they can be summed across all ramets or are identical across all ramets. For example, if each ramet has a unique character string in a column called “name”, there is no easy way to “sum” the character strings in this column to have one value for each genet. If you want the output data frame from <code><a href="reference/trackSpp.html">trackSpp()</a></code> to have the same columns as your input <code>dat</code> data.frame, set the <code>aggByGenet</code> argument to FALSE. However, Be Careful, since any demographic analysis should be done with a data.set that has only one row per genet, otherwise you will be estimating survival and growth rates on the scale of ramets instead of genets. If you take the <code>aggByGenet = FALSE</code> route, be sure to pass your dataset through the <code><a href="reference/aggregateByGenet.html">aggregateByGenet()</a></code> function (or aggregate to the genet scale using your preferred method) before demographic analysis.</li>
<li>
<strong><code>species/site/quad/year/geometry</code></strong> These arguments only need to be included if the columns in <code>dat</code> that contain the data for species, site, quadrat, year and geometry of each observation are <em>different</em> from the names “Species”, “Site”, “Quad”, “Year, and”geometry”. For example, if the column in your version of <code>dat</code> that contains the species identity of each observation is called “species_names”, then the argument <code>species = "species_names"</code> must be included in your call to <code><a href="reference/trackSpp.html">trackSpp()</a></code>.</li>
<li>
<strong><code>printMessages</code></strong> This is an optional logical argument that determines whether this function returns messages about genet aggregation, as well as messages indicating which year is the last year of sampling in each quadrat and which year(s) come before a gap in sampling that exceeds the <code>dorm</code> argument (and thus which years of data have an “NA” for “survives_tplus1” and “size_tplus1”). If <code>printMessages = TRUE</code> (the default), then messages are printed. If <code>printMessages = FALSE</code>, then messages are not printed.</li>
<li>
<strong><code>flagSuspects</code></strong> This is an optional logical argument of length 1, indicating whether observations that are “suspect” will be flagged. The default is<code>flagSuspects = FALSE</code>. If <code>flagSuspects = TRUE</code>, then a column called “Suspect” is added to the output data.frame. Any suspect observations get a “TRUE” in the “Suspect” column, while non-suspect observations receive a “FALSE”. There are two ways that an observation can be classified as “suspect”. First, if two consecutive observations have the same trackID, but the observation in year t+1 is less that a certain percentage (defined by the <code>shrink</code> arg.) of the observation in year t, it is possible that the observation in year t+1 is a new recruit and not the same individual. The second way an observation can be classified as “suspect” is if it is very small before going dormant. It is unlikely that a very small individual will survive dormancy, so it is possible that the function has mistakenly given a survival value of “1” to this individual. A “very small individual” is any observation with an area below a certain percentile (specified by <code>dormSize</code>) of the size distribution for this species, which is generated using all of the size data for this species in <code>dat</code>. If you are using the output dataset for demographic analysis, you may want to exclude “Suspect” observations. If <code>flagSuspects = FALSE</code>, then no additional column is added.</li>
<li>
<strong><code>shrink</code></strong> This is an optional argument that takes a single numeric value. This value is only used when <code>flagSuspects = TRUE</code>. When two consecutive observations have the same trackID, and the ratio of size_t+1 to size_t is smaller than the value of <code>shrink</code>, the observation in year t gets a “TRUE” in the “Suspect” column. For example, <code>shrink = 0.2</code>, and an individual that the tracking function has identified as “BOUGRA_1992_5” has an area of 9 cm<span class="math inline"><sup>2</sup></span> in year_t and an area of 1.35 cm<span class="math inline"><sup>2</sup></span> in year_t+1. The ratio of size_t+1 to size_t is 1.35/9 = 0.15, which is smaller than the cutoff specified by <code>shrink</code>, so the observation of “BOUGRA_1992_5” in year t gets a “TRUE” in the “Suspect” column. The default value is <code>shrink = 0.10</code>.</li>
<li>
<strong><code>dormSize</code></strong> This is an optional argument that takes a single numeric value. This value is only used when <code>flagSuspects = TRUE</code> and <code>dorm ≥ 1</code>. An individual is flagged as “suspect” if it “goes dormant” and has a size that is less than or equal to the percentile of the size distribution for this species that is designated by <code>dormSize</code>. For example, <code>dormSize = 0.05</code>, and an individual has a basal area of 0.5 cm<span class="math inline"><sup>2</sup></span>. The 5th percentile of the distribution of size for this species, which is made using the mean and standard deviation of all observations in <code>dat</code> for the species in question, is 0.6 cm<span class="math inline"><sup>2</sup></span>. This individual does not have any overlaps in the next year (year_t+1), but does have an overlap in year_t+2. However, because the basal area of this observation is smaller than the 5th percentile of size for this species, the observation in year t will get a “TRUE” in the “Suspect” column. It is possible that the tracking function has mistakenly assigned a “1” for survival in year_t, because it is unlikely that this individual is large enough to survive dormancy. The default value is <code>dormSize = .05</code>.</li>
</ul>
<p>These are all of the possible arguments to <code><a href="reference/trackSpp.html">trackSpp()</a></code>!</p>
<p><a id="trackSpp_out"></a></p>
</div>
<div class="section level4">
<h4 id="id_22-function-output">
<em>2.2</em> Function output<a class="anchor" aria-label="anchor" href="#id_22-function-output"></a>
</h4>
<p>Below is an example of a potential function call to <code><a href="reference/trackSpp.html">trackSpp()</a></code>, using the example <code>dat</code> and <code>inv</code> data we’ve used so far. :</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datTrackSpp</span> <span class="op">&lt;-</span> <span class="fu">plantTracker</span><span class="fu">::</span><span class="fu"><a href="reference/trackSpp.html">trackSpp</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, inv <span class="op">=</span> <span class="va">inv</span>,</span>
<span>         dorm <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         buff <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>         buffGenet <span class="op">=</span> <span class="fl">.005</span>,</span>
<span>         clonal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Species"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Heteropogon contortus"</span>,</span>
<span>                                           <span class="st">"Bouteloua rothrockii"</span>,</span>
<span>                                           <span class="st">"Ambrosia artemisiifolia"</span>,</span>
<span>                                           <span class="st">"Calliandra eriophylla"</span><span class="op">)</span>,</span>
<span>                             <span class="st">"clonal"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         aggByGenet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         printMessages <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>         <span class="op">)</span></span></code></pre></div>
<p>And here’s what the output of this call to <code><a href="reference/trackSpp.html">trackSpp()</a></code> looks like:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 477 features and 12 fields</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; Geometry type: GEOMETRY</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -0.001386579 ymin: -0.001017592 xmax: 1.000536 ymax: 1.001267</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; CRS:           NA</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; First 10 features:</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt;    Site Quad                 Species        trackID Year  type    basalArea</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; 1    AZ  SG2 Ambrosia artemisiifolia  AMBART_1922_1 1922 point 2.461883e-05</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; 2    AZ  SG2 Ambrosia artemisiifolia AMBART_1922_10 1922 point 2.461883e-05</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; 3    AZ  SG2 Ambrosia artemisiifolia AMBART_1922_11 1922 point 2.461883e-05</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; 4    AZ  SG2 Ambrosia artemisiifolia AMBART_1922_12 1922 point 2.461883e-05</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; 5    AZ  SG2 Ambrosia artemisiifolia AMBART_1922_13 1922 point 2.461883e-05</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; 6    AZ  SG2 Ambrosia artemisiifolia AMBART_1922_14 1922 point 2.461883e-05</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; 7    AZ  SG2 Ambrosia artemisiifolia AMBART_1922_15 1922 point 2.461883e-05</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; 8    AZ  SG2 Ambrosia artemisiifolia AMBART_1922_16 1922 point 2.461883e-05</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; 9    AZ  SG2 Ambrosia artemisiifolia AMBART_1922_17 1922 point 2.461883e-05</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; 10   AZ  SG2 Ambrosia artemisiifolia AMBART_1922_18 1922 point 2.461883e-05</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt;    recruit survives_t+1 age size_t+1 nearEdge                       geometry</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 1       NA            0  NA       NA     TRUE POLYGON ((0.350604 0.021361...</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; 2       NA            0  NA       NA    FALSE POLYGON ((0.7172048 0.25834...</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; 3       NA            0  NA       NA    FALSE POLYGON ((0.1845598 0.38566...</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; 4       NA            0  NA       NA    FALSE POLYGON ((0.759387 0.399850...</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; 5       NA            0  NA       NA    FALSE POLYGON ((0.1696044 0.40291...</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; 6       NA            0  NA       NA    FALSE POLYGON ((0.7290925 0.41097...</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; 7       NA            0  NA       NA    FALSE POLYGON ((0.6255546 0.45737...</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; 8       NA            0  NA       NA    FALSE POLYGON ((0.5872073 0.46925...</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; 9       NA            0  NA       NA    FALSE POLYGON ((0.8863168 0.52256...</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="co">#&gt; 10      NA            0  NA       NA    FALSE POLYGON ((0.5212498 0.52831...</span></span></code></pre></div>
<p>If you did not allow any species to be clonal (<code>clonal = 0</code>) or if <code>aggByGenet = TRUE</code> in your call to <code><a href="reference/trackSpp.html">trackSpp()</a></code>, then your output data frame will have one row for each genet, and is ready for demographic analysis! If your output data frame is <em>not</em> yet aggregated by genet (i.e. you use <code>aggByGenet = FALSE</code>), then you need to transform your data frame so that each genet is represented by only one row of data. You can use the <code><a href="reference/aggregateByGenet.html">aggregateByGenet()</a></code> function from <code>plantTracker</code> (see this function’s documentation for guidance), or your own method of choice.</p>
<p>You can stop here and proceed to your own analyses using the demographic data you generated, or you can proceed with other <code>plantTracker</code> functions outlined below for some additional useful data.</p>
<hr>
<p><a id="getNeigh"></a></p>
</div>
</div>
<div class="section level3">
<h3 id="id_3-calculate-local-neighborhood-density-using-getneighbors">
<em>3</em> Calculate local neighborhood density using <code>getNeighbors()</code>
<a class="anchor" aria-label="anchor" href="#id_3-calculate-local-neighborhood-density-using-getneighbors"></a>
</h3>
<p>It is often useful in demographic analyses to have some idea of the competition (or facilitation) that an individual organism is dealing with. Interactions between individuals can have a profound impact on whether an organism survives and grows. Spatial datasets of plant occurrence allow us to generate an estimate of the interactions an individual plant has with other plants by determining how many other individuals occupy the “local neighborhood” of each focal plant. While this isn’t a direct measure of competition or facilitation, it gives us an estimate that we can include in demographic models.</p>
<p>Here is the generic <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/getNeighbors.html">getNeighbors</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">buff</span>, <span class="va">method</span>, compType <span class="op">=</span> <span class="st">"allSpp"</span>, output <span class="op">=</span> <span class="st">"summed"</span>,</span>
<span>  trackID <span class="op">=</span> <span class="st">"trackID"</span>, species <span class="op">=</span> <span class="st">"Species"</span>, quad <span class="op">=</span> <span class="st">"Quad"</span>, year <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>  site <span class="op">=</span> <span class="st">"Site"</span>, geometry <span class="op">=</span> <span class="st">"geometry"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p><a id="getNeigh_args"></a></p>
<div class="section level4">
<h4 id="id_31-function-options-and-arguments">
<em>3.1</em> Function options and arguments<a class="anchor" aria-label="anchor" href="#id_31-function-options-and-arguments"></a>
</h4>
<p>The <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> function in <code>plantTracker</code> calculates local neighborhood density for each unique individual in your dataset. A user-specified buffer is drawn around each individual, and then the function counts the number of other plants within this buffer.This function can only be run on a dataset where each unique individual (genet) is represented by only one row of data. If the genet consists of multiple polygons, then they must be aggregated into one <code>sf</code> <code>MULTIPOLYGON</code> object. If your dataset has multiple rows for each genet, then you can use the <code><a href="reference/aggregateByGenet.html">aggregateByGenet()</a></code> function to get it ready to use in <code><a href="reference/getNeighbors.html">getNeighbors()</a></code>. Additionally, <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> requires your dataset to have a column containing a unique identifier for each genet. Across multiple years, that genet must have the same unique identifier. If you are using this function right after <code><a href="reference/trackSpp.html">trackSpp()</a></code>, your dataset will already have this unique identifier in a column called “trackID”.</p>
<p><code><a href="reference/getNeighbors.html">getNeighbors()</a></code> has several options that allow you to customize how local neighborhood density is calculated.</p>
<ul>
<li>First, the user can decide how the function “counts” other plants inside the buffer zone around the focal individual. Option 1) The function will tally the number of genets inside the buffer zone. Option 2) The function will calculate the proportion of the buffer zone that is occupied by other plants.</li>
<li>Second, the user can decide whether the function will calculate intraspecific local neighborhood density (only consider other plants in the buffer zone of the same species as the focal individual) or interspecific local neighborhood density (consider all other plants in the buffer zone, regardless of species).</li>
<li>Third, the user can decide whether the neighborhood density value (either a count or area) for each focal individual is a single value that sums the number or area of neighbors, or whether it is actually a list that provides the neighborhood density for each species present in the neighborhood.</li>
</ul>
<div class="figure" style="text-align: center">
<img src="reference/figures/README-unnamed-chunk-17-1.png" alt="Figure 3.1: This individual outlined in pink is a focal individual, and the pale pink shows a 10 cm buffer around it." width="100%"><p class="caption">
Figure 3.1: This individual outlined in pink is a focal individual, and the pale pink shows a 10 cm buffer around it.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="reference/figures/README-unnamed-chunk-19-1.png" alt="Figure 3.2: The 10cm buffer around the focal individual overlaps with 5 other unique individuals of two species. These overlapping individuals are outlined in dark grey. Using the 'count' method in `getNeighbors()`, we would get an intraspecific competition value of 3, and an interspecific competition value of 5." width="100%"><p class="caption">
Figure 3.2: The 10cm buffer around the focal individual overlaps with 5 other unique individuals of two species. These overlapping individuals are outlined in dark grey. Using the ‘count’ method in <code><a href="reference/getNeighbors.html">getNeighbors()</a></code>, we would get an intraspecific competition value of 3, and an interspecific competition value of 5.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="reference/figures/README-unnamed-chunk-20-1.png" alt="Figure 3.3: The 10cm buffer around the focal individual overlaps with 5 other unique individuals of two species. The overlapping area is shaded in grey. Using the 'area' method in `getNeighbors()`, we would get an intraspecific competition metric of 0.0454, and an interspecific competition metric of 0.0462." width="100%"><p class="caption">
Figure 3.3: The 10cm buffer around the focal individual overlaps with 5 other unique individuals of two species. The overlapping area is shaded in grey. Using the ‘area’ method in <code><a href="reference/getNeighbors.html">getNeighbors()</a></code>, we would get an intraspecific competition metric of 0.0454, and an interspecific competition metric of 0.0462.
</p>
</div>
<p>Below are the arguments in the <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> function.</p>
<ul>
<li>
<strong><code>dat</code></strong> An <code>sf</code> data frame in which each row represents data for a unique individual organism in a unique year. The <code>sf</code> geometry for each row must be either <code>MULTIPOLYGON</code> or <code>POLYGON</code> geometry. In addition to a “geometry” column, this data frame must have columns that contain data indicating the site, quadrat, site, and year of each observation. There also must be a column that contains a unique identifying value for each genet in each year. If <code>dat</code> is coming directly from <code><a href="reference/trackSpp.html">trackSpp()</a></code>, this column will be called “trackID”.<br>
</li>
<li>
<strong><code>buff</code></strong> This is a single numeric value that indicates the desired width of the “buffer” around the focal individual in which the competitors are to be counted. This value must be in the same units as the spatial information in <code>dat</code>.<br>
</li>
<li>
<strong><code>method</code></strong> This is a character string that must equal either <code>"count"</code> or <code>"area"</code>. If <code>method = "count"</code>, then the number of individuals in the buffer area will be tallied. If <code>method = "area"</code>, then the proportion of the buffer area that is occupied by other individuals will be calculated.</li>
<li>
<strong><code>compType</code></strong> This is a character string that must be either <code>"allSpp"</code> or <code>"oneSpp"</code>. If <code>compType = "allSpp"</code>, then a metric of interspecific competition is calculated, meaning that every individual within the buffer around the focal individual is considered, no matter the species. If <code>compType = "oneSpp"</code>, then a metric of intraspecific competition is calculated, meaning that only individuals of the same species as the focal individual will be considered when calculating the competition metric. If no value is provided, it will default to “allSpp”.</li>
<li>
<strong><code>output</code></strong> This is a character string that is set to either <code>"summed"</code> or <code>"bySpecies"</code>. The default is <code>"summed"</code>. This argument is only important to consider if you are using <code>compType = "allSpp"</code>. If <code>output = "summed"</code>, then only one count/area value is returned for each individual. This value is the total count or area of all neighbors within the focal species buffer zone, regardless of species. If <code>output = "bySpecies"</code>, there is a count or area value returned for each species present in the buffer zone. For example, you are using <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> with <code>method = "count"</code> and <code>compType = "allSpp"</code>. A focal individual in your dataset has seven other plants inside its buffer zone, three of species A, two of species B, and 2 of species C. If <code>output = "summed"</code>, the value in the “neighbors_count” column of the returned data frame will simply contain the value “7”. If <code>output = "bySpecies"</code>, the “neighbors_count” column for this individual will actually contain a named list <code>{r} list("Species A "= 5, "Species B" = 3, "Species C" = 7)</code>. The default value of <code>output</code> is <code>"summed"</code>.<br>
</li>
<li>
<strong><code>trackID/species/quad/year/site/geometry</code></strong> These arguments only need to be included if the columns in <code>dat</code> that contain the data for trackID, species, site, quadrat, year and geometry of each observation are <em>different</em> from the names “trackID,”Species”, “Site”, “Quad”, “Year, and”geometry”. For example, if the column in your version of <code>dat</code> that contains the species identity of each observation is called “species_names”, then the argument <code>species = "species_names"</code> must be included in your call to <code><a href="reference/getNeighbors.html">getNeighbors()</a></code>.</li>
</ul>
<p><a id="getNeigh_out"></a></p>
</div>
<div class="section level4">
<h4 id="id_32-function-outputs">
<em>3.2</em> Function outputs<a class="anchor" aria-label="anchor" href="#id_32-function-outputs"></a>
</h4>
<p>The output of <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> is an <code>sf</code> data frame that is identical to the input <code>dat</code>, but with either one or two additional columns. If <code>method = "area"</code>, there are two columns added called “nBuff_area” and “neighbors_area”. The first contains the area of the buffer zone around each focal individual. The second contains the basal area of neighbors that overlap with a focal individual’s buffer zone. If <code>method = "count"</code>, there is only one additional column added to the output, called “neighbors_count.” This column contains a count of the neighbors that occur within a focal individual’s buffer zone.</p>
<p>Here’s an example of a <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> function call using the resulting data from the example in section <em>2.2</em>, as well as the resulting data frame. Note that <code>method = "area"</code>, so two columns are added to the returned data frame:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datNeighbors</span> <span class="op">&lt;-</span> <span class="fu">plantTracker</span><span class="fu">::</span><span class="fu"><a href="reference/getNeighbors.html">getNeighbors</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">datTrackSpp</span>,</span>
<span>             buff <span class="op">=</span> <span class="fl">.15</span>,</span>
<span>             method <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>             compType <span class="op">=</span> <span class="st">"allSpp"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 477 features and 14 fields</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; Geometry type: GEOMETRY</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -0.001386579 ymin: -0.001017592 xmax: 1.000536 ymax: 1.001267</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; CRS:           NA</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; First 10 features:</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt;                    Species Site Quad        trackID Year neighbors_area</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; 1  Ambrosia artemisiifolia   AZ  SG2  AMBART_1922_1 1922   0.0011328591</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; 2  Ambrosia artemisiifolia   AZ  SG2 AMBART_1922_10 1922   0.0040518140</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; 3  Ambrosia artemisiifolia   AZ  SG2 AMBART_1922_11 1922   0.0055774468</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; 4  Ambrosia artemisiifolia   AZ  SG2 AMBART_1922_12 1922   0.0029129080</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; 5  Ambrosia artemisiifolia   AZ  SG2 AMBART_1922_13 1922   0.0050297901</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; 6  Ambrosia artemisiifolia   AZ  SG2 AMBART_1922_14 1922   0.0037646754</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; 7  Ambrosia artemisiifolia   AZ  SG2 AMBART_1922_15 1922   0.0026270846</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; 8  Ambrosia artemisiifolia   AZ  SG2 AMBART_1922_16 1922   0.0013297048</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; 9  Ambrosia artemisiifolia   AZ  SG2 AMBART_1922_17 1922   0.0022690175</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; 10 Ambrosia artemisiifolia   AZ  SG2 AMBART_1922_18 1922   0.0006338116</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt;    nBuff_area basalArea basalArea_genet survives_t+1 survives_tplus1 size_t+1</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; 1  0.04344697     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; 2  0.07329218     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; 3  0.07329218     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; 4  0.07329218     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; 5  0.07329218     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; 6  0.07329218     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; 7  0.07329218     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt; 8  0.07329218     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt; 9  0.06848976     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; 10 0.07329218     point    2.461883e-05           NA               0       NA</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">#&gt;    size_tplus1 nearEdge                       geometry</span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="co">#&gt; 1           NA     TRUE POLYGON ((0.350604 0.021361...</span></span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="co">#&gt; 2           NA    FALSE POLYGON ((0.7172048 0.25834...</span></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="co">#&gt; 3           NA    FALSE POLYGON ((0.1845598 0.38566...</span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a><span class="co">#&gt; 4           NA    FALSE POLYGON ((0.759387 0.399850...</span></span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a><span class="co">#&gt; 5           NA    FALSE POLYGON ((0.1696044 0.40291...</span></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co">#&gt; 6           NA    FALSE POLYGON ((0.7290925 0.41097...</span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="co">#&gt; 7           NA    FALSE POLYGON ((0.6255546 0.45737...</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a><span class="co">#&gt; 8           NA    FALSE POLYGON ((0.5872073 0.46925...</span></span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a><span class="co">#&gt; 9           NA    FALSE POLYGON ((0.8863168 0.52256...</span></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a><span class="co">#&gt; 10          NA    FALSE POLYGON ((0.5212498 0.52831...</span></span></code></pre></div>
<p>The example above uses the option <code>output = "summed"</code>, which is the default for the <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> function. With this option, the “neighbors_area” or “neighbors_count” column (depending on the <code>method</code> argument) contains just one value that sums the neighbor count or area across all neighbor species. However, if <code>output = "bySpecies"</code>, the “neighbors_count” or “neighbors_area” column contains a list with the counts or areas broken down by species. The <code>output</code> argument is described in more detail in section <em>3.1</em>. If you want to use the <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> function to determine how the effect of neighbors differs according to the species identity of those neighbors, setting <code>output = "bySpecies"</code> allows you to do this. However, it is likely that your subsequent analyses will need the by-species neighbor data in a matrix or data frame format, rather than in a list nested inside a data frame, which is how <code><a href="reference/getNeighbors.html">getNeighbors()</a></code> returns the data.</p>
<p>Here is some code that turns the data returned by <code>getNeighbors(output = "bySpecies")</code> into a matrix where each row has data for one focal individual, and each column has data for one species. This format should be easier to work with for further analysis.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save the output of the getNeighbors() function</span></span>
<span><span class="va">datNeighbors_bySpp</span> <span class="op">&lt;-</span> <span class="fu">plantTracker</span><span class="fu">::</span><span class="fu"><a href="reference/getNeighbors.html">getNeighbors</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">datTrackSpp</span>,</span>
<span>             buff <span class="op">=</span> <span class="fl">.15</span>, method <span class="op">=</span> <span class="st">"area"</span>, compType <span class="op">=</span> <span class="st">"allSpp"</span>, output <span class="op">=</span> <span class="st">"bySpecies"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># determine all of the possible species that can occupy the buffer zone</span></span>
<span><span class="va">compSpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">datTrackSpp</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">datNeighbors_bySpp</span><span class="op">$</span><span class="va">neighbors_area</span>,  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">tmp2</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">[</span><span class="va">compSpp</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># fix the column names</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temp</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">compSpp</span></span>
<span>  <span class="co"># save the data in a matrix</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">datOut</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">datOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">datOut</span>, <span class="va">temp</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># make the rownames of the matrix correspond to the trackID of the focal individual</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">datOut</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">datNeighbors_bySpp</span><span class="op">$</span><span class="va">trackID</span></span>
<span></span>
<span><span class="co"># show the first few rows of the datOut data frame: </span></span>
<span><span class="va">datOut</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;                Ambrosia artemisiifolia Bouteloua rothrockii</span></span>
<span><span class="co">#&gt; AMBART_1922_1             4.923767e-05         5.216672e-04</span></span>
<span><span class="co">#&gt; AMBART_1922_10            8.437672e-05         1.250163e-03</span></span>
<span><span class="co">#&gt; AMBART_1922_11            2.461883e-05         2.310445e-04</span></span>
<span><span class="co">#&gt; AMBART_1922_12            9.353468e-05         7.408342e-04</span></span>
<span><span class="co">#&gt; AMBART_1922_13            2.461883e-05         1.906272e-08</span></span>
<span><span class="co">#&gt;                Calliandra eriophylla Heteropogon contortus</span></span>
<span><span class="co">#&gt; AMBART_1922_1                     NA          0.0005619542</span></span>
<span><span class="co">#&gt; AMBART_1922_10                    NA          0.0027172740</span></span>
<span><span class="co">#&gt; AMBART_1922_11                    NA          0.0053217835</span></span>
<span><span class="co">#&gt; AMBART_1922_12                    NA          0.0020785392</span></span>
<span><span class="co">#&gt; AMBART_1922_13                    NA          0.0050051522</span></span></code></pre></div>
<hr>
<p><a id="next"></a></p>
</div>
</div>
<div class="section level3">
<h3 id="id_4-next-steps">
<em>4</em> Next steps<a class="anchor" aria-label="anchor" href="#id_4-next-steps"></a>
</h3>
<p>At this point, this dataset should be ready for you to use in any applications wish! There are a few additional functions that may help you in your analyses, and these are outlined in this section.</p>
<ul>
<li>Calculate recruitment by species-by-plot-by-year: the <code><a href="reference/getRecruits.html">getRecruits()</a></code> function</li>
<li>Calculate population rate of increase (lambda) for each species in a plot: the <code><a href="reference/getLambda.html">getLambda()</a></code> function</li>
<li>Calculate the basal area of each species in each quadrat in each year: the <code><a href="reference/getBasalAreas.html">getBasalAreas()</a></code> function</li>
<li>Make maps of quadrats over time: the <code><a href="reference/drawQuadMap.html">drawQuadMap()</a></code> function</li>
</ul>
<p>Specific instructions for how to use each of these functions can be found in their documentation!</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=plantTracker" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/aestears/plantTracker/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing plantTracker</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alice Stears <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1325-6641" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Jared Studyvin <br><small class="roles"> Author </small>  </li>
<li>David Atkins <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=plantTracker" class="external-link"><img src="https://www.r-pkg.org/badges/version/plantTracker" alt="CRAN status"></a></li>
<li><a href="https://github.com/aestears/plantTracker/actions/workflows/check-standard.yaml" class="external-link"><img src="https://github.com/aestears/plantTracker/actions/workflows/check-standard.yaml/badge.svg" alt="check-standard"></a></li>
<li><a href="https://github.com/aestears/plantTracker/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/aestears/plantTracker/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alice Stears, Jared Studyvin, David Atkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>





  </body>
</html>
